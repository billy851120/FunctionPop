<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <!-- <link href="../fpop_css/admin.min.css" rel="stylesheet"> -->
    <link rel="stylesheet" href="../_css/bootstrap.css">
    <link rel="stylesheet" href="../fpop_css/fpop.css">
    <script src="../_js/bootstrap.min.js"></script>
    <link rel="icon" href="/img/black_icon.png" type="image/gif" sizes="16x16">
    <title>f.pop 後台管理</title>
    <style>


    </style>

</head>

<body>
    <%- include("admin_navbar.ejs") %>

        <!-- ---------------------------------------------------------------------- -->

        <!-- Main Content -->
        <div class="fpop-main p-5">
            <div class="modal" id="myModal">
                <form id="form" class="modal-content" style="width: 400px;">
                    <div class="text-center p-4">
                        <input type="hidden" name="order_id">
                        <h3 class="font-weight-bold">訂單編號: 　<input class="modal-inp" type="text" name="order_list"></h3>
                        <br>
                        <h4 class="font-weight-bold">名稱: 　<input class="modal-inp" type="text" name="user_name"></h4>
                        <br>
                        <h4 class="font-weight-bold">信箱: 　<input class="modal-inp" type="text" name="user_email"></h4>
                        <br>
                        <h4 class="font-weight-bold">電話: 　<input class="modal-inp" type="text" name="user_phone"></h4>
                        <br>
                        <h4 class="font-weight-bold">地址: 　<input class="modal-inp" type="text" name="user_address"></h4>
                        <br>
                        <h4 class="font-weight-bold">下單時間: 　<input class="modal-inp" type="text" name="order_update">
                        </h4><br>
                    </div>
                </form>
            </div>
            <div class="col-lg mt-5">
                <div class="card h-100">
                    <div class="card-header">所有訂單編號</div>
                    <div class="card-body d-flex align-items-center">

                        <table class="table table-hover order-table">
                            <thead>
                                <th class="col-2">訂單編號</th>
                                <th class="col-1">名稱</th>
                                <th class="col-1">信箱</th>
                                <th class="col-1">電話</th>
                                <th class="col-3">地址</th>
                                <th class="col-2">下單時間</th>
                                <th class="col-1"></th>
                            </thead>
                            <tbody>
                                <% data.forEach((item ,index)=> { %>
                                    <tr>
                                        <td>
                                            <%= item.order_list %>
                                        </td>
                                        <td>
                                            <%= item.user_name %>
                                        </td>
                                        <td>
                                            <%= item.user_email %>
                                        </td>
                                        <td>
                                            <%= item.user_phone %>
                                        </td>
                                        <td>
                                            <%= item.user_address %>
                                        </td>
                                        <td>
                                            <%= moment(item.order_update).format(shortDataFormat) %>
                                        </td>
                                        <td>
                                            <button class="btn btn-outline-info btn-sm "
                                                onclick="Edit( <%= item.order_id %> )" class="btn btn-primary"
                                                data-toggle="modal" data-target="#myModal">訂單資訊</button>
                                        </td>

                                    </tr>
                                    <% }) %>
                            </tbody>
                        </table>

                    </div>
                    <div class="text-center mb-4">

                        <a href="/admin/goods/orderMgat_num/<%= i %>"><svg xmlns="http://www.w3.org/2000/svg" width="16"
                                height="16" fill="currentColor" class="bi bi-arrow-left-short" viewBox="0 0 16 16">
                                <path fill-rule="evenodd"
                                    d="M12 8a.5.5 0 0 1-.5.5H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H11.5a.5.5 0 0 1 .5.5z" />
                            </svg></a>
                        <a href="/admin/goods/orderMgat_num/<%= i %>"></a>
                        <% for(var i=1; i <=last_page; i++) { %>
                            <a href="/admin/goods/orderMgat_num/<%= i %>">
                                <%= i%>
                            </a>
                            <% } %>
                                <a href="/admin/goods/orderMgat_num/<%= i+1 %>"><svg xmlns="http://www.w3.org/2000/svg"
                                        width="16" height="16" fill="currentColor" class="bi bi-arrow-right-short"
                                        viewBox="0 0 16 16">
                                        <path fill-rule="evenodd"
                                            d="M4 8a.5.5 0 0 1 .5-.5h5.793L8.146 5.354a.5.5 0 1 1 .708-.708l3 3a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708-.708L10.293 8.5H4.5A.5.5 0 0 1 4 8z" />
                                    </svg></a>
                    </div>
                </div>
            </div>
            <p class="text-center mt-4">會員資料共 <%= total_nums %> 筆，共 <%= curr_page%>/<%= last_page%> 頁</p>

        </div>
        <script>
            function Edit(order_id) {
                $.ajax({
                    url: "http://localhost:3000/admin/goods/orderMgat_num/detail/" + order_id,
                    type: "GET",
                    success: function (res) {
                        console.log(order_id)
                        var res = JSON.parse(res)
                        //將值傳遞進input裏頭
                        $("input[name='order_id']").val(res.data.order_id)
                        $("input[name='order_list']").val(res.data.order_list)
                        $("input[name='user_name']").val(res.data.user_name)
                        $("input[name='user_email']").val(res.data.user_email)
                        $("input[name='user_phone']").val(res.data.user_phone)
                        $("input[name='user_address']").val(res.data.user_address)
                        $("input[name='order_update']").val(res.data.order_update)

                    },
                    error: function () {
                        console.log(order_id)
                        alert("系統錯誤!")
                    },
                })
            }
            function serializeToJSON(data) {
                var values = {};
                for (index in data) {
                    values[data[index].name] = data[index].value;
                }
                return JSON.stringify(values)
            }
        </script>
        <!-- Main Content end-->


        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js"></script>

</body>

</html>