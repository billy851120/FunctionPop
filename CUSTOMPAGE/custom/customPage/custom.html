<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="../_css/bootstrap.css">
    <script src="../_js/jquery.min.js"></script>
    <script src="../_js/popper.min.js"></script>
    <script src="../_js/bootstrap.min.js"></script>
    <script src="../_js/html2canvas_min.js"></script>

    <style>
        .nav_class {
            padding-left: 16.875%;
            padding-right: 16.875%;
            z-index: 5000;
        }

        .logo_where {
            margin-left: 25%;
        }

        .search_input {
            /* width: 150px; */
            height: 35px;
            border-radius: 50px;
        }

        .search_button {
            font-size: 0.9em;
        }

        .middleboard {
            overflow: hidden;
        }

        .uploadA,
        .uploadB {
            border: #363B36 solid 1px;
            width: 50%;
            height: 100%;
            float: left;
            overflow: hidden;
        }
    </style>
</head>

<body>
    <!-- navbar  -->
    <nav class="navbar fixed-top navbar-expand-lg navbar-light bg-white nav_class" id="navbarcolor">
        <a class="navbar-brand logo_where" href="#"><img src="../img/LOGO_black.png" alt=""></a>
        <button class=" navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <form class="form-inline my-2 mr-auto">
            <input class="form-control mr-sm-2 search_input" type="search" placeholder="Search" aria-label="Search">
            <button class="btn  my-2 my-sm-0 search_button" type="submit"></button>

        </form>
        <ul class="navbar-nav ">
            <li class="nav-item active">
                <a class="nav-link" href="#"><svg xmlns="http://www.w3.org/2000/svg" width="35" height="35"
                        fill="currentColor" class="bi bi-person-circle" viewBox="0 0 16 16">
                        <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0z" />
                        <path fill-rule="evenodd"
                            d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1z" />
                    </svg></a>
            </li>
            <li class="nav-item active">
                <a class="nav-link" href="#"><svg xmlns="http://www.w3.org/2000/svg" width="35" height="35"
                        fill="currentColor" class="bi bi-cart" viewBox="0 0 16 16">
                        <path
                            d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5zM3.102 4l1.313 7h8.17l1.313-7H3.102zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2z" />
                    </svg></a>
            </li>
            <li class="nav-item active">
                <a class="nav-link" href="#"><svg xmlns="http://www.w3.org/2000/svg" width="35" height="35"
                        fill="currentColor" class="bi bi-heart" viewBox="0 0 16 16">
                        <path
                            d="m8 2.748-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01L8 2.748zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143c.06.055.119.112.176.171a3.12 3.12 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15z" />
                    </svg></a>
            </li>
        </ul>

        <div
            style="border-radius: 10px;position: absolute; top:80px; border: 1px solid black; width: 66.25%; margin: 0 auto; height: 50px; background-color: gray;">
            <ul>
                <div class="navbar-nav " style="margin: 0 auto; width: 250px;height: 50px;   ">
                    <li class="nav-item active">
                        <a class="nav-link" href="#" style="color:white; font-size: 15px;">WOMEN <span
                                class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item active">
                        <a class="nav-link" href="#" style="color:white;font-size: 15px;">MEN</a>
                    </li>
                    <li class="nav-item dropdown active">
                        <a class="nav-link dropdown-toggle" style="color:white;font-size: 15px;" href="#"
                            id="navbarDropdown" role="button" data-toggle="dropdown" aria-expanded="false">
                            ACCESSORY
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="#">Apple</a>
                            <a class="dropdown-item" href="#">Bee</a>
                            <!-- <div class="dropdown-divider"></div> -->
                            <a class="dropdown-item" href="#">Cat</a>
                        </div>
                    </li>
                </div>
            </ul>

            <br>

        </div>
        <br>

    </nav>

    <!-- 小連結 -->
    <div style="position:relative; width: 50%; top: 180px; left: 16.875%;">
        <a href="" style="left: 16.875%;"> <b>首頁</b> </a>|
        <b>我的設計</b>
    </div>

    <!-- 客製化T  -->
    <div
        style="position:relative; width: 66.25%; top: 250px; left: 16.875%; border-bottom: 1px black solid; min-height: 700px;">
        <h4 style="text-align: center; margin-bottom: 40px;"> <b>客製化T恤</b> </h4>
        <span style="font-size: 15px;">STEP</span><b style="font-size: 18px;">1. 選擇顏色</b>


        <!-- 選擇顏色 -->
        <div style="display: inline-block; margin-left: 40px;">
            <div id="blackc" style="background-color:black; width: 26px; height: 26px;display: inline-block;">
            </div>
            <div id="whitec"
                style="margin-left: 9px;color:black; width: 26px; height: 26px;border: 1px black solid;display: inline-block;">
            </div>
            <div id="redc"
                style="margin-left: 9px;background-color:#91414C; width: 26px; height: 26px;display: inline-block;">
            </div>
            <div id="purplec"
                style="margin-left: 9px;background-color:#d17dbe; width: 26px; height: 26px;display: inline-block;">
            </div>
            <div id="yellowc"
                style="margin-left: 9px;background-color:#FFD233; width: 26px; height: 26px;display: inline-block;">
            </div>
            <div id="greenc"
                style="margin-left: 9px;background-color:#B9B89A; width: 26px; height: 26px;display: inline-block;">
            </div>
            <div id="bluec"
                style="margin-left: 9px;background-color:#A9C2C9; width: 26px; height: 26px;display: inline-block;">
            </div>
            <div id="darkbluec"
                style="margin-left: 9px;background-color:#363B36; width: 26px; height: 26px;display: inline-block;">
            </div>

        </div>

        <!-- 中間衣服畫板 -->
        <div id="capture" class="row middleboard" style="border: black solid 1px; height: 533px; margin-top: 60px;">

            <div class="col-6 move_place" id="target-container" ondragover="over(event)" ondrop="drop(event)"
                style="position: absolute; text-align: center; padding: 0;left: 0;">
                <img ondragover="over(event)" ondrop="drop(event)" id="cloth_front" src="../img/Tshirt/black_f.png"
                    alt="" style=" z-index: 500;margin-top: 2px;">
                <img id="cloth_fronto" src="../Tshirt/black_fo.png" alt=""
                    style="position: relative; top: -528px; z-index: 1500; pointer-events: none; margin-top: 2px;">

            </div>

            <div class="col-6 move_place" id="target-container" ondragover="over(event)" ondrop="drop(event)"
                style="position: absolute; text-align: center; padding: 0;right: 1px;">
                <img ondragover="over(event)" ondrop="drop(event)" id="cloth_back" src="../img/Tshirt/black_b.png"
                    alt="" style="z-index: 500; margin-top: 2px;">
                <img id="cloth_backo" src="../Tshirt/black_bo.png" alt=""
                    style="position: relative; top: -524px; z-index: 1500; pointer-events: none; margin-top: 2px;">
            </div>
        </div>


        <!-- STEP2之後 -->
        <div class="row" style="height: 300px; margin-top: 90px; z-index: 2000;">

            <div class="col-6" style="text-align: center;">
                <span style="font-size: 15px;">STEP</span><b style="font-size: 18px;">2. 上傳圖片</b>
                <br><br><br><br>
                <input id="myFile" type="file" style="border: black solid 1px; width: 33%; font-size: 15px;">

            </div>

            <div class="col-6" style="text-align: center;">
                <span style="font-size: 15px;">STEP</span><b style="font-size: 18px;">3. 將圖片拖曳至T恤</b>
                <div
                    style="width: 320px; height:180px; background-color: #d4d4d4; margin: 20px auto; border-radius: 10px;">
                    <div class="uploadA" id="upload_place"></div>
                    <div class="uploadB" id="upload_placeii"></div>
                </div>
            </div>
        </div>

        <div class="row" style="height: 350px;">

            <div class="col-6" style="text-align: center;">
                <span style="font-size: 15px;">STEP</span><b style="font-size: 18px;">4. 儲存</b>
                <br><br><br><br>
                <a href="#"><button onclick="divtoimg()"
                        style="background-color:white ; border-radius: 5px;">儲存設計</button> </a>

            </div>

            <div class="col-6" style=" text-align: center;">
                <span style="font-size: 15px;">STEP</span><b style="font-size: 18px;">5. 訂購數量&尺寸</b>
                <table style="margin:0 auto; width: 350px; height: 240px; margin-top: 50px;">
                    <tr>
                        <th style="width: 100px;">尺寸</th>
                        <th style="width: 100px;">數量</th>
                        <th style="width: 150px;">價格/每件</th>
                    </tr>
                    <tr>
                        <td>S</td>
                        <td><input type="text" style="width: 50px; height: 22px;"></td>
                        <td>NT$ 450</td>
                    </tr>
                    <tr>
                        <td>M</td>
                        <td><input type="text" style="width: 50px; height: 22px;"></td>
                        <td>NT$ 450</td>
                    </tr>
                    <tr>
                        <td>L</td>
                        <td><input type="text" style="width: 50px; height: 22px;"></td>
                        <td>NT$ 450</td>
                    </tr>
                    <tr>
                        <td>所有項目：</td>
                        <td></td>
                        <td>小計： NT$ <span>66666</span></td>
                    </tr>
                    <tr style="border-top: 1px solid rgb(165, 165, 165);">
                        <td></td>
                        <td></td>
                        <td style="visibility: hidden;">55</td>
                    </tr>
                    <tr>
                        <td></td>
                        <td></td>
                        <td style="margin-top:20px;"><button
                                style="background-color:white ; border-radius: 5px;">加入購物車</button></td>
                    </tr>
                </table>


            </div>
        </div>

    </div>


    <!-- 小介紹 -->
    <div style="position:relative; width: 28%; top: 300px; left: 16.875%;">
        <b>
            United Athle 頂級柔棉T恤 <br> <br>

            日本潮流品牌，精選頂級柔綿 <br>

            5.6盎司加上多色選擇 <br>

            人手必備一件的人氣單品 <br> <br> <br>
        </b>



        <span style="color:red ;"><b>*此款式屬於中性休閒版型，請參考尺寸表依個人穿衣習慣斟酌選購。</b></span>
    </div>


    <!-- 圖片介紹 -->
    <div style="text-align: center; position: relative; top: 400px;">
        <img src="../img/product_detail.png" alt="" style="width: 550px;">
        <br>
        <img src="../img/product_size.png" alt="" style="width: 450px;">
        <br>
        <img src="../img/product_more.png" alt="" style="width: 550px;">

    </div>


    <!-- footer  -->
    <footer style="width: 100%; position: relative; top: 500px; background-color: #d4d4d4; height: 80px;">
    </footer>
</body>



<script>

    var color_choose = function () {
        console.log(this.id);
        switch (this.id) {
            case "blackc":
                cloth_front.src = "../img/Tshirt/black_f.png";
                cloth_back.src = "../img/Tshirt/black_b.png";
                cloth_fronto.src = "../Tshirt/black_fo.png";
                cloth_backo.src = "../Tshirt/black_bo.png";
                cloth_backo.style.top = "-523px";
                break;
            case "whitec":
                cloth_front.src = "../img/Tshirt/white_f.png";
                cloth_back.src = "../img/Tshirt/white_b.png";
                cloth_fronto.src = "../Tshirt/white_fo.png";
                cloth_backo.src = "../Tshirt/white_bo.png";
                cloth_backo.style.top = "-527px";
                break;
            case "redc":
                cloth_front.src = "../img/Tshirt/darkred_f.png";
                cloth_back.src = "../img/Tshirt/darkred_b.png";
                cloth_fronto.src = "../Tshirt/darkred_fo.png";
                cloth_backo.src = "../Tshirt/darkred_bo.png";
                cloth_backo.style.top = "-529px";
                break;
            case "purplec":
                cloth_front.src = "../img/Tshirt/purple_f.png";
                cloth_back.src = "../img/Tshirt/purple_b.png";
                cloth_fronto.src = "../Tshirt/purple_fo.png";
                cloth_backo.src = "../Tshirt/purple_bo.png";
                cloth_backo.style.top = "-528px";
                break;
            case "yellowc":
                cloth_front.src = "../img/Tshirt/yellow_f.png";
                cloth_back.src = "../img/Tshirt/yellow_b.png";
                cloth_fronto.src = "../Tshirt/yellow_fo.png";
                cloth_backo.src = "../Tshirt/yellow_bo.png";
                cloth_backo.style.top = "-528px";
                break;
            case "greenc":
                cloth_front.src = "../img/Tshirt/green_f.png";
                cloth_back.src = "../img/Tshirt/green_b.png";
                cloth_fronto.src = "../Tshirt/green_fo.png";
                cloth_backo.src = "../Tshirt/green_bo.png";
                cloth_backo.style.top = "-529px";
                break;
            case "bluec":
                cloth_front.src = "../img/Tshirt/blue_f.png";
                cloth_back.src = "../img/Tshirt/blue_b.png";
                cloth_fronto.src = "../Tshirt/blue_fo.png";
                cloth_backo.src = "../Tshirt/blue_bo.png";
                cloth_backo.style.top = "-527px";
                break;
            case "darkbluec":
                cloth_front.src = "../img/Tshirt/darkblue_f.png";
                cloth_back.src = "../img/Tshirt/darkblue_b.png";
                cloth_fronto.src = "../Tshirt/darkblue_fo.png";
                cloth_backo.src = "../Tshirt/darkblue_bo.png";
                cloth_backo.style.top = "-529px";
                break;

        }
    }

    blackc.onclick = color_choose;
    whitec.onclick = color_choose;
    redc.onclick = color_choose;
    purplec.onclick = color_choose;
    yellowc.onclick = color_choose;
    greenc.onclick = color_choose;
    bluec.onclick = color_choose;
    darkbluec.onclick = color_choose;
</script>

<script>

    var real = true;
    var imgsrc = "";
    var src_arr = [];
    var uploadNum = 0;
    var fstmovsrc = "";
    // const myImg = new Image();

    myFile.onchange = function () {

        const reader = new FileReader();
        reader.readAsDataURL(myFile.files[0]);
        // console.log(myFile.files);
        reader.onload = function () {

            // console.log(reader.result);
            // 15. 透過 new Image() 記錄圖片
            //      * Image.src

            // 20. 將圖片顯示到網頁上

            const aamyImg = new Image();  // document.createElement('img'); // <img>
            src_arr[0] = reader.result;
            aamyImg.src = src_arr[0]; // <img src='data....'>
            aamyImg.id = "aamyImg";
            aamyImg.draggable = "true";
            aamyImg.style.zIndex = 1000;
            aamyImg.style.margin = "10px";
            aamyImg.addEventListener('dragstart', function () { start(event) }, false);
            // real = false;
            // var new_img_src = myImg.src;

            const bbmyImgb = new Image();  // document.createElement('img'); // <img>
            src_arr[1] = reader.result;
            bbmyImgb.src = src_arr[1]; // <img src='data....'>
            bbmyImgb.id = "bbmyImgb";
            bbmyImgb.draggable = "true";
            bbmyImgb.style.margin = "10px";
            bbmyImgb.addEventListener('dragstart', function () { start(event) }, false);
            // real = false;
            // var new_img_src = myImg.src;

            if (uploadNum == 0) {
                aamyImg.onload = function () {
                    // 　　a. 透過 <img>
                    aamyImg.style.width = "100px";
                    document.getElementById("upload_place").append(aamyImg);

                    $("#upload_place img").bind("mousewheel", function () {
                        zoomImg(this);
                        return false;
                    })
                    aamyImg.addEventListener("mousedown", (event) => {
                        console.log(this);
                        fstmovsrc = this.src;
                    })

                    uploadNum++;
                }
            }
            else {
                bbmyImgb.onload = function () {
                    // 　　a. 透過 <img>
                    bbmyImgb.style.width = "100px";
                    document.getElementById("upload_placeii").append(bbmyImgb);

                    $("#upload_placeii img").bind("mousewheel", function () {
                        zoomImg(this);
                        return false;
                    })
                    bbmyImgb.addEventListener("mousedown", (event) => {
                        console.log(this);
                        fstmovsrc = this.src;
                    })

                    uploadNum++;
                }
            }
        }
    }

    function zoomImg(o) {
        var zoom = parseInt(o.style.width);
        // console.log(event.wheelDelta)
        zoom += event.wheelDelta / 12;
        if (zoom > 0)
            o.style.width = zoom + "px";
        if (zoom > 500)
            o.style.width = "500px";
    }

</script>
<script>
    // 40. ondragover 拖動過程中，允許元素接受 drop 

    var co = 0;
    function over(evtobj) {
        evtobj.preventDefault();
    }

    // 50. ondragstart 當元素開始被拖動的時候，紀錄元素id
    // var moving_src = "";
    function start(evtobj) {
        console.log(evtobj);
        console.log(evtobj.target);
        // console.log(this);
        // moving_src = evtobj.target.src;
        var x = evtobj.offsetX,
            y = evtobj.offsetY;

        evtobj.dataTransfer.setData("text/plain", evtobj.target.id);
        evtobj.dataTransfer.setData('X', x);
        evtobj.dataTransfer.setData('Y', y);
        // evtobj.dataTransfer.setData('src', moving_src);
    }

    // 60. ondrop 滑鼠放開時，將元素附加到指定位置
    var drop_count = 0;
    var temp = "";
    function drop(evtobj) {
        drop_count++;
        // console.log(evtobj);
        // console.log(evtobj.target);
        // console.log(evtobj.target.tagName);
        var x = parseInt(evtobj.dataTransfer.getData('X'));
        var y = parseInt(evtobj.dataTransfer.getData('Y'));
        // var nsrc = evtobj.dataTransfer.getData('src');

        if (evtobj.target.tagName != "ASG") {
            temp = evtobj.dataTransfer.getData("text/plain");
            // document.getElementById(temp).src = nsrc;
            console.log(evtobj.target.id.substr(0, 2) != "aa");
            console.log(evtobj.target.id.substr(0, 2) != "bb");
            console.log((evtobj.target.id.substr(0, 2) != "aa") || (evtobj.target.id.substr(0, 2) != "bb"));

            if ((evtobj.target.id.substr(0, 2) != "aa") && (evtobj.target.id.substr(0, 2) != "bb")) {
                document.getElementById(temp).style.position = "absolute";
                document.getElementById(temp).style.left = evtobj.layerX - x + "px";
                document.getElementById(temp).style.top = evtobj.layerY - y + "px";
                document.getElementById(temp).style.margin = 0;
                document.getElementById(temp).addEventListener('dragstart', function () { start(event) }, false);

                evtobj.target.parentNode.appendChild(document.getElementById(temp));
                console.log(evtobj.target);
                console.log(temp);

                var tempstr = temp.substr(0, 2);
                console.log(tempstr);
                if (tempstr == "aa") {
                    appendnewimg();
                } else {
                    appendnewimgb();
                }
                // if(appendnum > 1){
                //     document.getElementById(`myImgaa${appendnum}`).remove();
                // }
                // // 刪除移動後會複製的原生物，只留下一個
                var ci = upload_place.children;
                var lis = Array.from(ci);
                console.log(lis);

                lis.forEach((index, e) => {
                    // console.log(index);
                    if (e > 0) {
                        index.remove();
                    }
                });

                var vi = upload_placeii.children;
                var lisv = Array.from(vi);
                console.log(lisv);

                lisv.forEach((index, e) => {
                    // console.log(index);
                    if (e > 0) {
                        index.remove();
                    }
                });
            }
        }
        co++;
    }

    // 移動後原本圖片會消失，重新加入
    var appendnum = 0;
    var appendnewimg = function () {

        // 　　a. 透過 <img>
        var ntemp = document.getElementById(temp).cloneNode(true);
        ntemp.id = `aamyImgaa${appendnum}`;

        // console.log(ntemp);
        document.getElementById("upload_place").appendChild(ntemp);
        document.getElementById(`aamyImgaa${appendnum}`).style.position = "relative";
        document.getElementById(`aamyImgaa${appendnum}`).style.left = 0;
        document.getElementById(`aamyImgaa${appendnum}`).style.top = 0;
        document.getElementById(`aamyImgaa${appendnum}`).addEventListener('dragstart', function () { start(event) }, false);
        $("#upload_place img").bind("mousewheel", function () {
            // console.log(myImg);
            zoomImg(this);
            return false;

        })
        appendnum++;

    }

    var appendbnum = 0;
    var appendnewimgb = function () {

        // 　　a. 透過 <img>
        var nbtemp = document.getElementById(temp).cloneNode(true);
        nbtemp.id = `bbmyImgbb${appendbnum}`;

        // console.log(ntemp);
        document.getElementById("upload_placeii").appendChild(nbtemp);
        document.getElementById(`bbmyImgbb${appendbnum}`).style.position = "relative";
        document.getElementById(`bbmyImgbb${appendbnum}`).style.left = 0;
        document.getElementById(`bbmyImgbb${appendbnum}`).style.top = 0;
        document.getElementById(`bbmyImgbb${appendbnum}`).addEventListener('dragstart', function () { start(event) }, false);
        $("#upload_placeii img").bind("mousewheel", function () {
            // console.log(myImg);
            zoomImg(this);
            return false;

        })
        appendbnum++;

    }
</script>
<script>
    function divtoimg() {
        html2canvas(document.querySelector("#capture")).then(function (canvas) {
            a = document.createElement("a");
            a.href = canvas
                .toDataURL("image/jpeg", 0.92)
                .replace("image/jpeg", "image/octet-stream");
            a.download = "image.jpg";
            a.click();
        });
    }
</script>
</html>